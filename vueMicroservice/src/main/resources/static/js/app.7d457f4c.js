(function(){"use strict";var e={510:function(e,n,t){var r=t(963),i=t(252);const o={class:"welcome"};function a(e,n,t,r,a,s){const l=(0,i.up)("MainVue");return(0,i.wg)(),(0,i.iD)("div",o,[(0,i.Wm)(l)])}const s=e=>((0,i.dD)("data-v-07e19730"),e=e(),(0,i.Cn)(),e),l={key:0},h={key:1},d={style:{"text-align":"center"}},c=s((()=>(0,i._)("label",{for:"showPlayers",class:"showPlayersCSS"},"Show Top Players",-1))),u={key:2};function p(e,n,t,r,o,a){const s=(0,i.up)("GameLogin"),p=(0,i.up)("SnakeGame"),g=(0,i.up)("TopPlayers");return(0,i.wg)(),(0,i.iD)(i.HY,null,[""===this.username?((0,i.wg)(),(0,i.iD)("div",l,[(0,i.Wm)(s,{onLogin:a.setUserData},null,8,["onLogin"])])):(0,i.kq)("",!0),""!==this.username?((0,i.wg)(),(0,i.iD)("div",h,[(0,i.Wm)(p,{onUpdatescore:a.setHighscore,player:this.username,highscore:this.highscore},null,8,["onUpdatescore","player","highscore"])])):(0,i.kq)("",!0),(0,i._)("div",d,[(0,i._)("input",{type:"checkbox",onChange:n[0]||(n[0]=(...e)=>a.showTopPlayers&&a.showTopPlayers(...e)),checked:"true",id:"showPlayers",class:"showPlayersCSS"},null,32),c]),this.showPlayers?((0,i.wg)(),(0,i.iD)("div",u,[(0,i.Wm)(g)])):(0,i.kq)("",!0)],64)}var g=t(577);const m=e=>((0,i.dD)("data-v-12cb84d6"),e=e(),(0,i.Cn)(),e),y={class:"main"},v=m((()=>(0,i._)("br",null,null,-1))),f=m((()=>(0,i._)("p",null,[(0,i.Uk)("Wenn Sie nicht wissen, wie das Spiel funktionniert dann können Sie sich "),(0,i._)("a",{href:"https://www.spielbar.de/node/145443"},"hier"),(0,i.Uk)(" informieren. ")],-1))),w={id:"canvas"},k=m((()=>(0,i._)("canvas",{id:"myCanvas",width:"400",height:"400"},null,-1))),_=[k],b=m((()=>(0,i._)("p",null,[(0,i.Uk)("Fortgeschrittene Webprogrammierung - Team02 "),(0,i._)("br"),(0,i.Uk)(),(0,i._)("i",null,"SS2022")],-1)));function x(e,n,t,o,a,s){const l=(0,i.up)("GameOver");return(0,i.wg)(),(0,i.iD)("div",y,[(0,i._)("h1",null,"Willkommen "+(0,g.zw)(t.player)+" zum SnakeGame!",1),v,(0,i.wy)((0,i._)("h2",null,"Aktuelle Punktzahl: "+(0,g.zw)(a.currentScore)+", Highscore: "+(0,g.zw)(t.highscore),513),[[r.F8,a.alive]]),f,(0,i.wy)((0,i._)("div",w,_,512),[[r.F8,a.alive]]),(0,i.wy)((0,i._)("div",null,[(0,i.Wm)(l,{finalscore:this.currentScore},null,8,["finalscore"])],512),[[r.F8,!a.alive]]),b])}const S=e=>((0,i.dD)("data-v-793f124e"),e=e(),(0,i.Cn)(),e),P=S((()=>(0,i._)("br",null,null,-1))),C={id:"gameOver"},T=S((()=>(0,i._)("h1",null,"GAME OVER",-1))),O=S((()=>(0,i._)("p",null," In kürze geht es für dich weiter :)",-1)));function z(e,n,t,r,o,a){return(0,i.wg)(),(0,i.iD)(i.HY,null,[P,(0,i._)("div",C,[T,(0,i._)("p",null,"Sie haben folgenden Score erreicht: "+(0,g.zw)(t.finalscore),1),O])],64)}var D={name:"GameOver",props:["finalscore"],data(){return{}},methods:{}},L=t(744);const G=(0,L.Z)(D,[["render",z],["__scopeId","data-v-793f124e"]]);var U=G,N={name:"SnakeGame",props:["player","highscore"],data(){return{gridsize:10,ws:null,alive:!0,currentScore:null}},mounted(){let e=this,n=document.getElementById("myCanvas");this.context=n.getContext("2d"),window.addEventListener("keyup",(function(n){e.control(n)})),window.addEventListener("deviceorientation",(function(n){e.handleDeviceOrientation(n)})),this.handleCon()},methods:{control(e){38!==e.keyCode&&87!==e.keyCode||!this.alive?40!==e.keyCode&&83!==e.keyCode||!this.alive?37!==e.keyCode&&65!==e.keyCode||!this.alive?39!==e.keyCode&&68!==e.keyCode||!this.alive||this.sendCommand(1):this.sendCommand(3):this.sendCommand(2):this.sendCommand(0)},handleDeviceOrientation(e){e.beta>20&&this.alive?this.sendCommand(2):e.beta<-20&&this.alive?this.sendCommand(0):e.gamma<-20&&this.alive?this.sendCommand(3):e.gamma>20&&this.alive&&this.sendCommand(1)},handleCon(){const e="ws://localhost:8085/socket";this.ws=new WebSocket(e),this.ws.onmessage=e=>{this.clearCanvas(this.context),this.data=e.data;let n=JSON.parse(e.data);this.playerPosition(n,this.context),this.generatePickups(n,this.context)},this.ws.onopen=()=>{this.ws.send('{"player": "'+this.player+'", "createNewPlayer": '+!0+"}")},this.ws.onclose=()=>{this.updateScore()}},sendCommand(e){let n='{"player": "'+this.player+'","createNewPlayer": "'+!1+'", "direction": '+e+"}";this.ws.send(n)},updateScore(){const e={method:"PATCH",Accept:"application/json"};fetch("http://localhost:8082/user/update?name="+this.player+"&score="+this.currentScore,e).then((e=>e.text())).then((e=>{this.$emit("updatescore",JSON.parse(e))})).catch((e=>{console.error("Error:",e)}))},generatePickups(e,n){let t=e.Pickups;for(let r in t)n.fillStyle=t[r].color,n.fillRect(t[r].x,t[r].y,this.gridsize,this.gridsize)},playerPosition(e,n){let t=e.player;for(let r in t){this.player===t[r].username&&(t[r].alive?this.$emit("score",this.currentScore):this.updateScore(),this.currentScore=t[r].score.valueOf(),this.alive=t[r].alive),n.beginPath();let e=t[r].direction;10!=this.gridsize&&(n.beginPath(),n.fillStyle=t[r].color,n.fillRect(t[r].head.x,t[r].head.y,this.gridsize,this.gridsize),n.closePath()),1==e?(this.drawTriangle(n,t[r].head.x,t[r].head.y,t[r].head.x,t[r].head.y+10,t[r].head.x+5,t[r].head.y+5,t[r].color),this.drawLine(n,t[r].head.x+5,t[r].head.y+5,t[r].head.x+8,t[r].head.y+5,"red"),this.drawLine(n,t[r].head.x+8,t[r].head.y+5,t[r].head.x+10,t[r].head.y,"red"),this.drawLine(n,t[r].head.x+8,t[r].head.y+5,t[r].head.x+10,t[r].head.y+10,"red")):3==e?(this.drawTriangle(n,t[r].head.x+10,t[r].head.y,t[r].head.x+10,t[r].head.y+10,t[r].head.x+5,t[r].head.y+5,t[r].color),this.drawLine(n,t[r].head.x+5,t[r].head.y+5,t[r].head.x+2,t[r].head.y+5,"red"),this.drawLine(n,t[r].head.x+2,t[r].head.y+5,t[r].head.x,t[r].head.y,"red"),this.drawLine(n,t[r].head.x+2,t[r].head.y+5,t[r].head.x,t[r].head.y+10,"red")):0==e?(this.drawTriangle(n,t[r].head.x,t[r].head.y+10,t[r].head.x+10,t[r].head.y+10,t[r].head.x+5,t[r].head.y+5,t[r].color),this.drawLine(n,t[r].head.x+5,t[r].head.y+5,t[r].head.x,t[r].head.y,"red")):(this.drawTriangle(n,t[r].head.x,t[r].head.y,t[r].head.x+10,t[r].head.y,t[r].head.x+5,t[r].head.y+5,t[r].color),this.drawLine(n,t[r].head.x+5,t[r].head.y+5,t[r].head.x,t[r].head.y+10,"red")),n.beginPath(),n.fillStyle=t[r].color;for(let i in t[r].position)n.fillRect(t[r].position[i].x,t[r].position[i].y,this.gridsize,this.gridsize);n.closePath()}},clearCanvas(e){let n=document.getElementById("myCanvas");e.clearRect(0,0,n.width,n.height)},drawTriangle(e,n,t,r,i,o,a,s){e.beginPath(),e.fillStyle=s,e.moveTo(n,t),e.lineTo(r,i),e.lineTo(o,a),e.closePath(),e.fill()},drawLine(e,n,t,r,i,o){e.beginPath(),e.moveTo(n,t),e.lineTo(r,i),e.strokeStyle=o,e.stroke(),e.closePath()}},components:{GameOver:U}};const W=(0,L.Z)(N,[["render",x],["__scopeId","data-v-12cb84d6"]]);var E=W;const H=e=>((0,i.dD)("data-v-a612d220"),e=e(),(0,i.Cn)(),e),F={class:"main"},j=H((()=>(0,i._)("h1",{class:"welcome"},"Willkommen zum SnakeGame",-1))),A=H((()=>(0,i._)("p",null,"Geben Sie bitte Ihren Usernamen in das Loginfeld ein, um das Spiel zu beginnen",-1))),I={id:"login"},M=H((()=>(0,i._)("h3",null,"Login",-1))),Z=H((()=>(0,i._)("p",null," ",-1))),q=H((()=>(0,i._)("p",null,[(0,i.Uk)("Fortgeschrittene Webprogrammierung - Team02 "),(0,i._)("br"),(0,i.Uk)(),(0,i._)("i",null,"SS2022")],-1)));function R(e,n,t,o,a,s){return(0,i.wg)(),(0,i.iD)("div",F,[j,A,(0,i._)("div",I,[M,Z,(0,i.wy)((0,i._)("input",{onKeyup:n[0]||(n[0]=(0,r.D2)((e=>s.login()),["enter"])),type:"text",name:"username","onUpdate:modelValue":n[1]||(n[1]=e=>a.name=e),placeholder:"Username"},null,544),[[r.nr,a.name]]),(0,i._)("button",{type:"button",onClick:n[2]||(n[2]=e=>s.login())},"Login")]),q])}var V={name:"GameLogin",data(){return{name:""}},methods:{login(){if(""!==this.name){const e=this.name,n={method:"PUT",Accept:"application/json"};fetch("http://localhost:8082/user/add?name="+e+"&score=0",n).then((e=>e.text())).then((e=>{const n=JSON.parse(e);this.$emit("login",n),console.log("Success",e)})).catch((e=>{console.error("Error:",e)}))}}}};const J=(0,L.Z)(V,[["render",R],["__scopeId","data-v-a612d220"]]);var Y=J;const B=e=>((0,i.dD)("data-v-56c47551"),e=e(),(0,i.Cn)(),e),$=B((()=>(0,i._)("br",null,null,-1))),K={id:"topPlayers"},Q=B((()=>(0,i._)("h1",null,"Top Players",-1))),X=B((()=>(0,i._)("tr",null,[(0,i._)("th",null," Position "),(0,i._)("th",null," Spieler"),(0,i._)("th",null," Highscore")],-1)));function ee(e,n,t,r,o,a){return(0,i.wg)(),(0,i.iD)(i.HY,null,[$,(0,i._)("div",K,[Q,(0,i._)("table",null,[X,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.players,((e,n)=>((0,i.wg)(),(0,i.iD)("tr",{key:n},[(0,i._)("td",null,(0,g.zw)(n+1),1),(0,i._)("td",null,(0,g.zw)(e.username),1),(0,i._)("td",null,(0,g.zw)(e.highscore),1)])))),128))])])],64)}var ne={name:"TopPlayers",data(){return{players:""}},mounted(){this.getPlayers()},methods:{getPlayers(){fetch("http://localhost:8082/user/get").then((e=>e.text())).then((e=>{const n=JSON.parse(e);n.sort(((e,n)=>parseFloat(n.highscore)-parseFloat(e.highscore))),this.players=n})).catch((e=>{console.error("Error:",e)}))}}};const te=(0,L.Z)(ne,[["render",ee],["__scopeId","data-v-56c47551"]]);var re=te,ie={name:"MainVue",data(){return{username:"",highscore:"",showPlayers:!0}},components:{SnakeGame:E,GameLogin:Y,TopPlayers:re},methods:{setUserData(e){this.username=e.username,this.highscore=e.highscore},setHighscore(e){this.highscore<e.highscore&&(this.highscore=e.highscore,this.sendMsg())},sendMsg(){let e=this.highscore;Notification.requestPermission((function(n){"granted"===n?navigator.serviceWorker.ready.then((function(n){const t={body:"Neuer Highscore: "+e};n.showNotification("Glückwunsch! Sie haben ihren Highscore gebrochen!",t)})):console.log("No permission to send notifications!")}))},showTopPlayers(e){this.showPlayers=e.target.checked}}};const oe=(0,L.Z)(ie,[["render",p],["__scopeId","data-v-07e19730"]]);var ae=oe,se={name:"App",components:{MainVue:ae}};const le=(0,L.Z)(se,[["render",a]]);var he=le,de=t(205);(0,de.z)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}}),(0,r.ri)(he).mount("#app")}},n={};function t(r){var i=n[r];if(void 0!==i)return i.exports;var o=n[r]={exports:{}};return e[r](o,o.exports,t),o.exports}t.m=e,function(){var e=[];t.O=function(n,r,i,o){if(!r){var a=1/0;for(d=0;d<e.length;d++){r=e[d][0],i=e[d][1],o=e[d][2];for(var s=!0,l=0;l<r.length;l++)(!1&o||a>=o)&&Object.keys(t.O).every((function(e){return t.O[e](r[l])}))?r.splice(l--,1):(s=!1,o<a&&(a=o));if(s){e.splice(d--,1);var h=i();void 0!==h&&(n=h)}}return n}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[r,i,o]}}(),function(){t.d=function(e,n){for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){var e={143:0};t.O.j=function(n){return 0===e[n]};var n=function(n,r){var i,o,a=r[0],s=r[1],l=r[2],h=0;if(a.some((function(n){return 0!==e[n]}))){for(i in s)t.o(s,i)&&(t.m[i]=s[i]);if(l)var d=l(t)}for(n&&n(r);h<a.length;h++)o=a[h],t.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return t.O(d)},r=self["webpackChunkvue_src"]=self["webpackChunkvue_src"]||[];r.forEach(n.bind(null,0)),r.push=n.bind(null,r.push.bind(r))}();var r=t.O(void 0,[998],(function(){return t(510)}));r=t.O(r)})();
//# sourceMappingURL=app.7d457f4c.js.map